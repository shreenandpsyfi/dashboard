<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>User Profiling - Parliament Chart</title>
    <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        body, html {
            margin: 0;
            padding: 0;
            width: 100%;
            min-height: 100vh;
            background-color: #2d3139;
        }
        #root {
            min-height: 100vh;
        }
        @keyframes fadeIn {
            from { opacity: 0; transform: scale(0.95); }
            to { opacity: 1; transform: scale(1); }
        }
        .profile-card {
            animation: fadeIn 0.3s ease-out;
        }
    </style>
</head>
<body>
    <div id="root"></div>
    <script type="text/babel">
        const { useState, useMemo } = React;

        const ParliamentChart = () => {
          const [data, setData] = useState([
            { 
              cluster: 'The Pragmatic Optimiser', 
              size: 75, 
              color: '#843356',
              description: 'Pragmatic Optimisers are solution-oriented individuals who balance realism with a positive outlook. They focus on practical outcomes while maintaining hope for better results.',
              traits: ['Solution-focused', 'Realistic yet hopeful', 'Action-oriented', 'Adaptable']
            },
            { 
              cluster: 'The Emotionally Engaged', 
              size: 27, 
              color: '#CE575D',
              description: 'Emotionally Engaged individuals deeply connect with their feelings and the emotions of others. They bring empathy and emotional intelligence to every situation.',
              traits: ['Highly empathetic', 'Emotionally aware', 'Relationship-focused', 'Intuitive']
            },
            { 
              cluster: 'The Clarity Seeking Professional', 
              size: 33, 
              color: '#FF6F61',
              description: 'Clarity Seeking Professionals prioritize clear communication and well-defined goals. They excel in structured environments and value transparency.',
              traits: ['Detail-oriented', 'Process-driven', 'Clear communicator', 'Goal-focused']
            },
            { 
              cluster: 'The Grounded Go-Getter', 
              size: 33, 
              color: '#802F9D',
              description: 'Grounded Go-Getters combine ambition with practicality. They pursue their goals with determination while staying connected to reality.',
              traits: ['Ambitious', 'Practical', 'Determined', 'Results-driven']
            },
            { 
              cluster: 'The Pattern Breaker', 
              size: 18, 
              color: '#EBD2F9',
              description: 'Pattern Breakers challenge conventional thinking and embrace innovation. They see opportunities where others see obstacles.',
              traits: ['Innovative', 'Non-conformist', 'Creative thinker', 'Risk-taker']
            }
          ]);

          const [hoveredCluster, setHoveredCluster] = useState(null);
          const [selectedCluster, setSelectedCluster] = useState(null);

          const totalSeats = data.reduce((sum, d) => sum + d.size, 0);

          const seats = useMemo(() => {
            // PERFECT 180째 SEMICIRCLE - 6 rows instead of 7 for better distribution
            const rows = 6;
            const seatsPerRow = [13, 17, 21, 26, 31, 37]; // Fixed seats per row for even distribution
            const innerRadius = 160;
            const rowSpacing = 30;
            const centerX = 400;
            const centerY = 420;
            
            const allPositions = [];
            
            for (let row = 0; row < rows; row++) {
              const radius = innerRadius + row * rowSpacing;
              const seatsInThisRow = seatsPerRow[row];
              
              for (let seat = 0; seat < seatsInThisRow; seat++) {
                // PERFECT 180째 angle: from 180째 (left) to 0째 (right)
                const angle = 180 - (seat / (seatsInThisRow - 1)) * 180;
                const radian = (angle * Math.PI) / 180;
                const x = centerX + radius * Math.cos(radian);
                const y = centerY - radius * Math.sin(radian);
                
                allPositions.push({
                  x,
                  y,
                  angle,
                  radius: 11
                });
              }
            }
            
            // Sort by angle LEFT to RIGHT
            allPositions.sort((a, b) => b.angle - a.angle);
            
            // Assign clusters LEFT to RIGHT
            let currentClusterIndex = 0;
            let seatsAssignedInCurrentCluster = 0;
            
            const seatsWithClusters = allPositions.slice(0, totalSeats).map((pos, idx) => {
              while (seatsAssignedInCurrentCluster >= data[currentClusterIndex].size && currentClusterIndex < data.length - 1) {
                currentClusterIndex++;
                seatsAssignedInCurrentCluster = 0;
              }
              
              const cluster = data[currentClusterIndex];
              seatsAssignedInCurrentCluster++;
              
              return {
                ...pos,
                cluster: cluster.cluster,
                color: cluster.color,
                size: cluster.size
              };
            });
            
            return seatsWithClusters;
          }, [data, totalSeats]);

          const centerInfo = useMemo(() => {
            if (hoveredCluster) {
              const cluster = data.find(d => d.cluster === hoveredCluster);
              return { size: cluster.size, name: cluster.cluster };
            }
            return { size: totalSeats, name: '' };
          }, [hoveredCluster, data, totalSeats]);

          const clusterZones = useMemo(() => {
            const zones = [];
            data.forEach(cluster => {
              const clusterSeats = seats.filter(s => s.cluster === cluster.cluster);
              if (clusterSeats.length === 0) return;
              
              const minX = Math.min(...clusterSeats.map(s => s.x));
              const maxX = Math.max(...clusterSeats.map(s => s.x));
              const minY = Math.min(...clusterSeats.map(s => s.y));
              const maxY = Math.max(...clusterSeats.map(s => s.y));
              
              zones.push({
                cluster: cluster.cluster,
                x: minX - 20,
                y: minY - 20,
                width: maxX - minX + 40,
                height: maxY - minY + 40
              });
            });
            return zones;
          }, [seats, data]);

          const handleClusterClick = (clusterName) => {
            const cluster = data.find(d => d.cluster === clusterName);
            setSelectedCluster(cluster);
          };

          return (
            <div style={{ 
              minHeight: '100vh', 
              backgroundColor: '#2d3139', 
              display: 'flex', 
              flexDirection: 'column', 
              alignItems: 'center', 
              padding: '2rem',
              paddingBottom: '4rem',
              position: 'relative'
            }}>
              <h1 style={{ 
                color: 'white', 
                fontSize: '3rem', 
                fontWeight: 'bold', 
                marginBottom: '2rem',
                letterSpacing: '0.05em'
              }}>User Profiling</h1>

              <div style={{ marginBottom: '3rem' }}>
                <svg width="800" height="550" style={{ display: 'block' }}>
                  {clusterZones.map((zone, idx) => (
                    <rect
                      key={`zone-${idx}`}
                      x={zone.x}
                      y={zone.y}
                      width={zone.width}
                      height={zone.height}
                      fill="transparent"
                      style={{ cursor: 'pointer' }}
                      onMouseEnter={() => setHoveredCluster(zone.cluster)}
                      onMouseLeave={() => setHoveredCluster(null)}
                      onClick={() => handleClusterClick(zone.cluster)}
                    />
                  ))}
                  
                  {seats.map((seat, idx) => (
                    <circle
                      key={idx}
                      cx={seat.x}
                      cy={seat.y}
                      r={seat.radius}
                      fill={seat.color}
                      opacity={hoveredCluster === null || hoveredCluster === seat.cluster ? 1 : 0.3}
                      style={{
                        transition: 'all 0.2s',
                        filter: hoveredCluster === seat.cluster ? 'brightness(1.15)' : 'none',
                        pointerEvents: 'none'
                      }}
                    />
                  ))}

                  <text
                    x="400"
                    y="425"
                    textAnchor="middle"
                    style={{ 
                      fontFamily: 'Arial, sans-serif', 
                      fontWeight: 700,
                      fontSize: '96px',
                      fill: 'white',
                      userSelect: 'none',
                      pointerEvents: 'none'
                    }}
                  >
                    {centerInfo.size}
                  </text>
                  
                  {hoveredCluster && (
                    <text
                      x="400"
                      y="455"
                      textAnchor="middle"
                      style={{ 
                        fontSize: '13px',
                        fill: 'white',
                        userSelect: 'none',
                        pointerEvents: 'none'
                      }}
                    >
                      {centerInfo.name}
                    </text>
                  )}
                </svg>
              </div>

              <div style={{ 
                width: '100%', 
                maxWidth: '800px',
                marginTop: '2rem'
              }}>
                <div style={{ 
                  display: 'flex', 
                  justifyContent: 'space-between', 
                  alignItems: 'center',
                  marginBottom: '1rem',
                  paddingBottom: '0.5rem',
                  borderBottom: '1px solid #6b7280'
                }}>
                  <h2 style={{ 
                    color: 'white', 
                    fontSize: '0.875rem', 
                    fontWeight: 600,
                    letterSpacing: '0.025em'
                  }}>Cluster</h2>
                  <h2 style={{ 
                    color: 'white', 
                    fontSize: '0.875rem', 
                    fontWeight: 600,
                    letterSpacing: '0.025em'
                  }}>Cluster Size</h2>
                </div>
                {data.map((item, idx) => (
                  <div
                    key={idx}
                    style={{
                      display: 'flex',
                      justifyContent: 'space-between',
                      alignItems: 'center',
                      padding: '0.625rem 0.5rem',
                      borderRadius: '0.25rem',
                      cursor: 'pointer',
                      transition: 'all 0.15s',
                      backgroundColor: hoveredCluster === item.cluster ? 'rgba(255,255,255,0.08)' : 'transparent'
                    }}
                    onMouseEnter={() => setHoveredCluster(item.cluster)}
                    onMouseLeave={() => setHoveredCluster(null)}
                    onClick={() => handleClusterClick(item.cluster)}
                  >
                    <div style={{ display: 'flex', alignItems: 'center', gap: '0.75rem' }}>
                      <div
                        style={{ 
                          width: '12px', 
                          height: '12px', 
                          borderRadius: '50%',
                          backgroundColor: item.color,
                          flexShrink: 0
                        }}
                      />
                      <span style={{ color: 'white', fontSize: '0.875rem' }}>{item.cluster}</span>
                    </div>
                    <span style={{ color: 'white', fontSize: '0.875rem', fontWeight: 500 }}>{item.size}</span>
                  </div>
                ))}
              </div>

              {/* Profile Card Modal */}
              {selectedCluster && (
                <div 
                  style={{
                    position: 'fixed',
                    top: 0,
                    left: 0,
                    right: 0,
                    bottom: 0,
                    backgroundColor: 'rgba(0, 0, 0, 0.8)',
                    display: 'flex',
                    alignItems: 'center',
                    justifyContent: 'center',
                    zIndex: 1000,
                    padding: '2rem'
                  }}
                  onClick={() => setSelectedCluster(null)}
                >
                  <div 
                    className="profile-card"
                    style={{
                      backgroundColor: '#1a1f2e',
                      borderRadius: '1rem',
                      padding: '3rem',
                      maxWidth: '600px',
                      width: '100%',
                      boxShadow: '0 25px 50px -12px rgba(0, 0, 0, 0.5)',
                      border: `3px solid ${selectedCluster.color}`,
                      background: `linear-gradient(135deg, #1a1f2e 0%, #252b3d 100%)`
                    }}
                    onClick={(e) => e.stopPropagation()}
                  >
                    {/* Header */}
                    <div style={{ marginBottom: '2rem', textAlign: 'center' }}>
                      <div style={{
                        display: 'inline-block',
                        width: '60px',
                        height: '60px',
                        borderRadius: '50%',
                        backgroundColor: selectedCluster.color,
                        marginBottom: '1rem'
                      }} />
                      <h2 style={{
                        color: 'white',
                        fontSize: '2rem',
                        fontWeight: 'bold',
                        marginBottom: '0.5rem'
                      }}>
                        {selectedCluster.cluster}
                      </h2>
                      <p style={{
                        color: '#9ca3af',
                        fontSize: '1.125rem',
                        fontWeight: 600
                      }}>
                        {selectedCluster.size} Participants
                      </p>
                    </div>

                    {/* Description */}
                    <div style={{ marginBottom: '2rem' }}>
                      <h3 style={{
                        color: 'white',
                        fontSize: '1.125rem',
                        fontWeight: 600,
                        marginBottom: '0.75rem'
                      }}>
                        Overview
                      </h3>
                      <p style={{
                        color: '#d1d5db',
                        fontSize: '1rem',
                        lineHeight: '1.6'
                      }}>
                        {selectedCluster.description}
                      </p>
                    </div>

                    {/* Key Traits */}
                    <div style={{ marginBottom: '2rem' }}>
                      <h3 style={{
                        color: 'white',
                        fontSize: '1.125rem',
                        fontWeight: 600,
                        marginBottom: '0.75rem'
                      }}>
                        Key Traits
                      </h3>
                      <div style={{ display: 'flex', flexWrap: 'wrap', gap: '0.5rem' }}>
                        {selectedCluster.traits.map((trait, idx) => (
                          <span
                            key={idx}
                            style={{
                              backgroundColor: selectedCluster.color,
                              color: 'white',
                              padding: '0.5rem 1rem',
                              borderRadius: '9999px',
                              fontSize: '0.875rem',
                              fontWeight: 500
                            }}
                          >
                            {trait}
                          </span>
                        ))}
                      </div>
                    </div>

                    {/* Close Button */}
                    <button
                      onClick={() => setSelectedCluster(null)}
                      style={{
                        width: '100%',
                        padding: '0.75rem',
                        backgroundColor: selectedCluster.color,
                        color: 'white',
                        border: 'none',
                        borderRadius: '0.5rem',
                        fontSize: '1rem',
                        fontWeight: 600,
                        cursor: 'pointer',
                        transition: 'all 0.2s'
                      }}
                      onMouseEnter={(e) => e.target.style.opacity = '0.9'}
                      onMouseLeave={(e) => e.target.style.opacity = '1'}
                    >
                      Close
                    </button>
                  </div>
                </div>
              )}
            </div>
          );
        };

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<ParliamentChart />);
    </script>
</body>
</html>
