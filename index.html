<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>User Profiling - Parliament Chart</title>
    <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        body, html {
            margin: 0;
            padding: 0;
            width: 100%;
            min-height: 100vh;
            background-color: #2d3139;
        }
        #root {
            min-height: 100vh;
        }
    </style>
</head>
<body>
    <div id="root"></div>
    <script type="text/babel">
        const { useState, useMemo } = React;

        const ParliamentChart = () => {
          const [data, setData] = useState([
            { cluster: 'The Pragmatic Optimiser', size: 74, color: '#B85860' },
            { cluster: 'The Emotionally Engaged', size: 27, color: '#7A4458' },
            { cluster: 'The Clarity Seeking Professional', size: 33, color: '#E07856' },
            { cluster: 'The Grounded Go-Getter', size: 33, color: '#9370DB' },
            { cluster: 'The Pattern Breaker', size: 18, color: '#D4BADB' }
          ]);

          const [hoveredCluster, setHoveredCluster] = useState(null);

          const totalSeats = data.reduce((sum, d) => sum + d.size, 0);

          const seats = useMemo(() => {
            const rows = 7;
            const innerRadius = 150;
            const rowSpacing = 26;
            const centerX = 400;
            const centerY = 380;
            const arcAngle = 180;
            const startAngle = 180;
            const endAngle = 0;
            
            const allPositions = [];
            
            for (let row = 0; row < rows; row++) {
              const radius = innerRadius + row * rowSpacing;
              const circumference = Math.PI * radius;
              const seatsInThisRow = Math.round(circumference / 22);
              
              for (let seat = 0; seat < seatsInThisRow; seat++) {
                const angle = 180 - (seat / (seatsInThisRow - 1)) * arcAngle;
                const radian = (angle * Math.PI) / 180;
                const x = centerX + radius * Math.cos(radian);
                const y = centerY - radius * Math.sin(radian);
                
                allPositions.push({
                  x,
                  y,
                  angle,
                  radius: 10
                });
              }
            }
            
            allPositions.sort((a, b) => b.angle - a.angle);
            
            let currentClusterIndex = 0;
            let seatsAssignedInCurrentCluster = 0;
            
            const seatsWithClusters = allPositions.slice(0, totalSeats).map((pos, idx) => {
              while (seatsAssignedInCurrentCluster >= data[currentClusterIndex].size && currentClusterIndex < data.length - 1) {
                currentClusterIndex++;
                seatsAssignedInCurrentCluster = 0;
              }
              
              const cluster = data[currentClusterIndex];
              seatsAssignedInCurrentCluster++;
              
              return {
                ...pos,
                cluster: cluster.cluster,
                color: cluster.color,
                size: cluster.size
              };
            });
            
            return seatsWithClusters;
          }, [data, totalSeats]);

          const centerInfo = useMemo(() => {
            if (hoveredCluster) {
              const cluster = data.find(d => d.cluster === hoveredCluster);
              return { size: cluster.size, name: cluster.cluster };
            }
            return { size: totalSeats, name: '' };
          }, [hoveredCluster, data, totalSeats]);

          const clusterZones = useMemo(() => {
            const zones = [];
            data.forEach(cluster => {
              const clusterSeats = seats.filter(s => s.cluster === cluster.cluster);
              if (clusterSeats.length === 0) return;
              
              const minX = Math.min(...clusterSeats.map(s => s.x));
              const maxX = Math.max(...clusterSeats.map(s => s.x));
              const minY = Math.min(...clusterSeats.map(s => s.y));
              const maxY = Math.max(...clusterSeats.map(s => s.y));
              
              zones.push({
                cluster: cluster.cluster,
                x: minX - 20,
                y: minY - 20,
                width: maxX - minX + 40,
                height: maxY - minY + 40
              });
            });
            return zones;
          }, [seats, data]);

          return (
            <div style={{ 
              minHeight: '100vh', 
              backgroundColor: '#2d3139', 
              display: 'flex', 
              flexDirection: 'column', 
              alignItems: 'center', 
              padding: '2rem',
              paddingBottom: '4rem'
            }}>
              <h1 style={{ 
                color: 'white', 
                fontSize: '3rem', 
                fontWeight: 'bold', 
                marginBottom: '2rem',
                letterSpacing: '0.05em'
              }}>User Profiling</h1>

              <div style={{ marginBottom: '3rem' }}>
                <svg width="800" height="500" style={{ display: 'block' }}>
                  {clusterZones.map((zone, idx) => (
                    <rect
                      key={`zone-${idx}`}
                      x={zone.x}
                      y={zone.y}
                      width={zone.width}
                      height={zone.height}
                      fill="transparent"
                      style={{ cursor: 'pointer' }}
                      onMouseEnter={() => setHoveredCluster(zone.cluster)}
                      onMouseLeave={() => setHoveredCluster(null)}
                    />
                  ))}
                  
                  {seats.map((seat, idx) => (
                    <circle
                      key={idx}
                      cx={seat.x}
                      cy={seat.y}
                      r={seat.radius}
                      fill={seat.color}
                      opacity={hoveredCluster === null || hoveredCluster === seat.cluster ? 1 : 0.3}
                      style={{
                        transition: 'all 0.2s',
                        filter: hoveredCluster === seat.cluster ? 'brightness(1.15)' : 'none',
                        pointerEvents: 'none'
                      }}
                    />
                  ))}

                  <text
                    x="400"
                    y="385"
                    textAnchor="middle"
                    style={{ 
                      fontFamily: 'Arial, sans-serif', 
                      fontWeight: 700,
                      fontSize: '96px',
                      fill: 'white',
                      userSelect: 'none',
                      pointerEvents: 'none'
                    }}
                  >
                    {centerInfo.size}
                  </text>
                  
                  {hoveredCluster && (
                    <text
                      x="400"
                      y="415"
                      textAnchor="middle"
                      style={{ 
                        fontSize: '13px',
                        fill: 'white',
                        userSelect: 'none',
                        pointerEvents: 'none'
                      }}
                    >
                      {centerInfo.name}
                    </text>
                  )}
                </svg>
              </div>

              <div style={{ 
                width: '100%', 
                maxWidth: '800px',
                marginTop: '2rem'
              }}>
                <div style={{ 
                  display: 'flex', 
                  justifyContent: 'space-between', 
                  alignItems: 'center',
                  marginBottom: '1rem',
                  paddingBottom: '0.5rem',
                  borderBottom: '1px solid #6b7280'
                }}>
                  <h2 style={{ 
                    color: 'white', 
                    fontSize: '0.875rem', 
                    fontWeight: 600,
                    letterSpacing: '0.025em'
                  }}>Cluster</h2>
                  <h2 style={{ 
                    color: 'white', 
                    fontSize: '0.875rem', 
                    fontWeight: 600,
                    letterSpacing: '0.025em'
                  }}>Cluster Size</h2>
                </div>
                {data.map((item, idx) => (
                  <div
                    key={idx}
                    style={{
                      display: 'flex',
                      justifyContent: 'space-between',
                      alignItems: 'center',
                      padding: '0.625rem 0.5rem',
                      borderRadius: '0.25rem',
                      cursor: 'pointer',
                      transition: 'all 0.15s',
                      backgroundColor: hoveredCluster === item.cluster ? 'rgba(255,255,255,0.08)' : 'transparent'
                    }}
                    onMouseEnter={() => setHoveredCluster(item.cluster)}
                    onMouseLeave={() => setHoveredCluster(null)}
                  >
                    <div style={{ display: 'flex', alignItems: 'center', gap: '0.75rem' }}>
                      <div
                        style={{ 
                          width: '12px', 
                          height: '12px', 
                          borderRadius: '50%',
                          backgroundColor: item.color,
                          flexShrink: 0
                        }}
                      />
                      <span style={{ color: 'white', fontSize: '0.875rem' }}>{item.cluster}</span>
                    </div>
                    <span style={{ color: 'white', fontSize: '0.875rem', fontWeight: 500 }}>{item.size}</span>
                  </div>
                ))}
              </div>
            </div>
          );
        };

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<ParliamentChart />);
    </script>
</body>
</html>
